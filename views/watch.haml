%html
  %head
    %title= @id
    %script{:src => "/js/jquery-1.8.3.min.js", :type => "text/javascript"}
    :javascript
      var i = 0;

      function start(){
        setInterval( "refreshStream()", 2000 );
      }

      function refreshStream(){
        $('#stream').css("top", "50%"); 
        $('#stream').css("left", "50%"); 
        $('#stream').css("width", $('#stream').width());
        $('#stream').css("height", $('#stream').height());
        $('#stream').css("margin-top", $('#stream').height() / -2);
        $('#stream').css("margin-left", $('#stream').width() / -2);
        i++;
      }

      $(document).ready(function(){
        //$('#imgContainer').height($(window).height());

        setInterval(function () {
          // I'm only asking you to remember one thing.
          $.post('/stream_has_been_updated', { version: $('#version').text() },
            function(response){
              console.log(response);
              if (response.answer == 'yes') {
                $('#stream').attr('src', response.src);
                $('#version').text(response.version);
              }

            });
        }, 1000);
        
      });
    :css
      html {
        background: rgb(30, 30, 30);
      }
      img {
        position: absolute;
      }
    #version 0
    %img#stream
